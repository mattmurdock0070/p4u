{"ast":null,"code":"import _toConsumableArray from\"/home/ubuntu/p4u/frontend/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _regeneratorRuntime from\"/home/ubuntu/p4u/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/home/ubuntu/p4u/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/home/ubuntu/p4u/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useRef}from'react';import useState from'react-usestateref';import io from'socket.io-client';import{useNavigate}from'react-router-dom';import Cookies from'universal-cookie';import Header from'../Header';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var bu=process.env.REACT_APP_BASEURL;var Adminchat=function Adminchat(){var navigate=useNavigate();var cookies=new Cookies();var _useState=useState([]),_useState2=_slicedToArray(_useState,3),data=_useState2[0],setUserData=_useState2[1],ref=_useState2[2];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),messages=_useState4[0],setMessages=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),input=_useState6[0],setInput=_useState6[1];var token=cookies.get('jwtoken');var login=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var res,error,userData;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return fetch(\"\".concat(bu,\"/afterlogin\"),{method:'GET',headers:{Accept:'application/json','Content-Type':'application/json',Authorization:\"Bearer \".concat(token)}});case 3:res=_context.sent;if(!(res.status===401)){_context.next=7;break;}error=new Error(res.error);throw error;case 7:_context.next=9;return res.json();case 9:userData=_context.sent;setUserData(userData);//  console.log(userData);\n_context.next=16;break;case 13:_context.prev=13;_context.t0=_context[\"catch\"](0);navigate('/login');case 16:case\"end\":return _context.stop();}}},_callee,null,[[0,13]]);}));return function login(){return _ref.apply(this,arguments);};}();useEffect(function(){login();},[]);var socket=useRef(null);useEffect(function(){socket.current=io('https://paws-4-you-2.onrender.com');socket.current.on('connect',function(){// console.log('Socket.IO connected');\n});socket.current.on('message',function(message){setMessages(function(prevMessages){return[].concat(_toConsumableArray(prevMessages),[{content:message.content,sender:message.sender}]);});});socket.current.on('disconnect',function(){//console.log('Socket.IO disconnected');\n});return function(){socket.current.disconnect();};},[]);var sendMessage=function sendMessage(){if(input.trim()){var message={content:input,sender:\"Admin\"// Include the user's name here\n};socket.current.emit('message',{message:message});setInput('');}};var styles={container:{display:'flex',flexDirection:'column',alignItems:'center',marginTop:'20px'},messages:{border:'1px solid black',height:'300px',width:'100%',maxWidth:'600px',overflowY:'scroll',padding:'10px',marginBottom:'10px',backgroundColor:'#f9f9f9'},messageContainer:{marginBottom:'5px',padding:'5px',borderRadius:'5px'},message:{marginBottom:'5px',background:'#36d6ad',// Light green background color\npadding:'5px',borderRadius:'5px'// Light green background color\n},adminMessage:{marginBottom:'5px',padding:'5px',borderRadius:'5px',textAlign:'right'},inputContainer:{display:'flex',justifyContent:'center',alignItems:'center',width:'100%',maxWidth:'600px'},input:{width:'80%',padding:'10px',border:'1px solid #ccc',borderRadius:'4px',marginRight:'10px'},button:{padding:'10px 20px',border:'none',backgroundColor:'#007bff',color:'white',borderRadius:'4px',cursor:'pointer'},buttonHover:{backgroundColor:'#0056b3'}};return/*#__PURE__*/_jsxs(_Fragment,{children:[ref.current.usertype==='2'&&navigate('/login'),/*#__PURE__*/_jsx(Header,{}),/*#__PURE__*/_jsxs(\"div\",{style:styles.container,children:[/*#__PURE__*/_jsx(\"h2\",{children:\"You are logged in as admin \"}),/*#__PURE__*/_jsx(\"div\",{style:styles.messages,children:messages.map(function(message,index){return/*#__PURE__*/_jsx(\"div\",{style:styles.messageContainer,children:/*#__PURE__*/_jsxs(\"div\",{style:message.sender==='Admin'?styles.adminMessage:styles.message,children:[/*#__PURE__*/_jsxs(\"strong\",{children:[message.sender,\": \"]}),\" \",message.content]})},index);})}),/*#__PURE__*/_jsxs(\"div\",{style:styles.inputContainer,children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:input,onChange:function onChange(e){return setInput(e.target.value);},onKeyDown:function onKeyDown(e){return e.key==='Enter'&&sendMessage();},style:styles.input}),/*#__PURE__*/_jsx(\"button\",{onClick:sendMessage,style:styles.button,onMouseOver:function onMouseOver(e){return e.currentTarget.style.backgroundColor=styles.buttonHover.backgroundColor;},onMouseOut:function onMouseOut(e){return e.currentTarget.style.backgroundColor=styles.button.backgroundColor;},children:\"Send\"})]})]})]});};export default Adminchat;","map":{"version":3,"names":["React","useEffect","useRef","useState","io","useNavigate","Cookies","Header","bu","process","env","REACT_APP_BASEURL","Adminchat","navigate","cookies","data","setUserData","ref","messages","setMessages","input","setInput","token","get","login","fetch","method","headers","Accept","Authorization","res","status","error","Error","json","userData","socket","current","on","message","prevMessages","content","sender","disconnect","sendMessage","trim","emit","styles","container","display","flexDirection","alignItems","marginTop","border","height","width","maxWidth","overflowY","padding","marginBottom","backgroundColor","messageContainer","borderRadius","background","adminMessage","textAlign","inputContainer","justifyContent","marginRight","button","color","cursor","buttonHover","usertype","map","index","e","target","value","key","currentTarget","style"],"sources":["/home/ubuntu/p4u/frontend/src/Components/adminPages/Adminchat.js"],"sourcesContent":["import React, { useEffect, useRef } from 'react';\r\nimport useState from 'react-usestateref';\r\nimport io from 'socket.io-client';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport Cookies from 'universal-cookie';\r\nimport Header from '../Header';\r\n\r\nconst bu = process.env.REACT_APP_BASEURL;\r\n\r\nconst Adminchat = () => {\r\n    const navigate = useNavigate();\r\n    const cookies = new Cookies();\r\n\r\n    const [data, setUserData, ref] = useState([]);\r\n    const [messages, setMessages] = useState([]);\r\n    const [input, setInput] = useState('');\r\n    \r\n    const token = cookies.get('jwtoken');\r\n\r\n    const login = async () => {\r\n        try {\r\n            const res = await fetch(`${bu}/afterlogin`, {\r\n                method: 'GET',\r\n                headers: {\r\n                    Accept: 'application/json',\r\n                    'Content-Type': 'application/json',\r\n                    Authorization: `Bearer ${token}`,\r\n                },\r\n            });\r\n            if (res.status === 401) {\r\n                const error = new Error(res.error);\r\n                throw error;\r\n            }\r\n            const userData = await res.json();\r\n            setUserData(userData);\r\n          //  console.log(userData);\r\n        } catch (err) {\r\n            navigate('/login');\r\n        }\r\n    };\r\n\r\n    useEffect(() => {\r\n        login();\r\n    }, []);\r\n\r\n    const socket = useRef(null);\r\n\r\n    useEffect(() => {\r\n        socket.current = io('https://paws-4-you-2.onrender.com');\r\n\r\n        socket.current.on('connect', () => {\r\n           // console.log('Socket.IO connected');\r\n        });\r\n\r\n        socket.current.on('message', (message) => {\r\n            setMessages((prevMessages) => [...prevMessages, { content: message.content, sender: message.sender }]);\r\n        });\r\n\r\n        socket.current.on('disconnect', () => {\r\n            //console.log('Socket.IO disconnected');\r\n        });\r\n\r\n        return () => {\r\n            socket.current.disconnect();\r\n        };\r\n    }, []);\r\n\r\n    const sendMessage = () => {\r\n        if (input.trim()) {\r\n            const message = {\r\n                content: input,\r\n                sender: \"Admin\" // Include the user's name here\r\n            };\r\n            \r\n            socket.current.emit('message', { message });\r\n            setInput('');\r\n        }\r\n    };\r\n\r\n    const styles = {\r\n        container: {\r\n            display: 'flex',\r\n            flexDirection: 'column',\r\n            alignItems: 'center',\r\n            marginTop: '20px',\r\n        },\r\n        messages: {\r\n            border: '1px solid black',\r\n            height: '300px',\r\n            width: '100%',\r\n            maxWidth: '600px',\r\n            overflowY: 'scroll',\r\n            padding: '10px',\r\n            marginBottom: '10px',\r\n            backgroundColor: '#f9f9f9',\r\n        },\r\n        messageContainer: {\r\n            marginBottom: '5px',\r\n            padding: '5px',\r\n            borderRadius: '5px',\r\n        },\r\n        message: {\r\n          marginBottom: '5px',\r\n          background: '#36d6ad', // Light green background color\r\n          padding: '5px',\r\n          borderRadius: '5px',// Light green background color\r\n        },\r\n        adminMessage: {\r\n          marginBottom: '5px',\r\n          padding: '5px',\r\n          borderRadius: '5px',\r\n          textAlign: 'right',\r\n        },\r\n        inputContainer: {\r\n            display: 'flex',\r\n            justifyContent: 'center',\r\n            alignItems: 'center',\r\n            width: '100%',\r\n            maxWidth: '600px',\r\n        },\r\n        input: {\r\n            width: '80%',\r\n            padding: '10px',\r\n            border: '1px solid #ccc',\r\n            borderRadius: '4px',\r\n            marginRight: '10px',\r\n        },\r\n        button: {\r\n            padding: '10px 20px',\r\n            border: 'none',\r\n            backgroundColor: '#007bff',\r\n            color: 'white',\r\n            borderRadius: '4px',\r\n            cursor: 'pointer',\r\n        },\r\n        buttonHover: {\r\n            backgroundColor: '#0056b3',\r\n        },\r\n    };\r\n\r\n    return (\r\n        <>\r\n            {ref.current.usertype=== '2' && navigate('/login')}\r\n            <Header />\r\n            <div style={styles.container}>\r\n                <h2>You are logged in as admin </h2>\r\n                <div style={styles.messages}>\r\n                    {messages.map((message, index) => (\r\n                        <div key={index} style={styles.messageContainer}>\r\n                            <div style={message.sender === 'Admin' ? styles.adminMessage : styles.message}>\r\n                                <strong>{message.sender}: </strong> {message.content}\r\n                            </div>\r\n                        </div>\r\n                    ))}\r\n                </div>\r\n                <div style={styles.inputContainer}>\r\n                    <input\r\n                        type=\"text\"\r\n                        value={input}\r\n                        onChange={(e) => setInput(e.target.value)}\r\n                        onKeyDown={(e) => e.key === 'Enter' && sendMessage()}\r\n                        style={styles.input}\r\n                    />\r\n                    <button\r\n                        onClick={sendMessage}\r\n                        style={styles.button}\r\n                        onMouseOver={(e) => (e.currentTarget.style.backgroundColor = styles.buttonHover.backgroundColor)}\r\n                        onMouseOut={(e) => (e.currentTarget.style.backgroundColor = styles.button.backgroundColor)}\r\n                    >\r\n                        Send\r\n                    </button>\r\n                </div>\r\n            </div>\r\n        </>\r\n    );\r\n};\r\n\r\nexport default Adminchat;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}